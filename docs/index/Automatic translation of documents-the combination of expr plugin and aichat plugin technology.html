<!DOCTYPE html>
<html lang="zh_CN" data-theme-mode="light" data-light-theme="daylight" data-dark-theme="midnight">
<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>
<style>
  :root {
    --oceanpress-header-bg: #f8f9fa;
    --oceanpress-header-border: #e9ecef;
    --oceanpress-header-text: #007bff;
    --oceanpress-footer-bg: #f8f9fa;
    --oceanpress-footer-text: #007bff;
  }
  
  [data-theme-mode="dark"] {
    --oceanpress-header-bg: #2d2d2d;
    --oceanpress-header-border: #404040;
    --oceanpress-header-text: #58a6ff;
    --oceanpress-footer-bg: #2d2d2d;
    --oceanpress-footer-text: #58a6ff;
  }
  
  .header-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background-color: var(--oceanpress-header-bg);
    border-bottom: 1px solid var(--oceanpress-header-border);
  }
  .home-button {
    text-decoration: none;
    color: var(--oceanpress-header-text);
    font-weight: bold;
    font-size: 16px;
  }
  .home-button:hover {
    text-decoration: underline;
  }
  #search {
    width: 300px;
  }
  
  .theme-aware-footer {
    margin-top: 30px;
    padding: 20px;
    background-color: var(--oceanpress-footer-bg);
    text-align: center;
  }
  .theme-aware-footer p {
    margin: 0;
  }
  .theme-aware-footer a {
    color: var(--oceanpress-footer-text);
    text-decoration: none;
  }
  .theme-aware-footer a:hover {
    text-decoration: underline;
  }
</style>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="description" content="Automatic translation of documents-the combination of expr plugin and aichat plugin technology ä¸­æ–‡ç‰ˆ : è‡ªåŠ¨ç¿»è¯‘æ–‡æ¡£-expræ’ä»¶å’Œaichatæ’ä»¶çš„ç»„åˆæŠ€ Current article's English transl..." />
  <meta name="keywords" content="block, expr, const, plugin, sourceid, updated, translated, aichat" />
  <meta name="author" content="å´®ç”Ÿ" />
  <meta property="og:title" content="Automatic translation of documents-the combination of expr plugin and aichat plugin technology" />
  <meta property="og:description" content="Automatic translation of documents-the combination of expr plugin and aichat plugin technology ä¸­æ–‡ç‰ˆ : è‡ªåŠ¨ç¿»è¯‘æ–‡æ¡£-expræ’ä»¶å’Œaichatæ’ä»¶çš„ç»„åˆæŠ€ Current article's English transl..." />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="/index/Automatic translation of documents-the combination of expr plugin and aichat plugin technology.html" />
  <meta property="og:site_name" content="OceanPress" />
  <meta property="article:published_time" content="2025-03-08T19:15:32Z" />
  <meta property="article:modified_time" content="2025-03-08T19:44:06Z" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Automatic translation of documents-the combination of expr plugin and aichat plugin technology" />
  <meta name="twitter:description" content="Automatic translation of documents-the combination of expr plugin and aichat plugin technology ä¸­æ–‡ç‰ˆ : è‡ªåŠ¨ç¿»è¯‘æ–‡æ¡£-expræ’ä»¶å’Œaichatæ’ä»¶çš„ç»„åˆæŠ€ Current article's English transl..." />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="/index/Automatic translation of documents-the combination of expr plugin and aichat plugin technology.html" />

  <link rel="stylesheet" type="text/css" id="baseStyle" href="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/stage/build/export/base.css?2.10.5"/>
  <script>
  // æ›´å¥½çš„ä¸»é¢˜åˆ‡æ¢æ–¹æ¡ˆ
  (function() {
    // ä¸»é¢˜é…ç½®
    const themes = {
      light: {
        name: 'daylight',
        mode: 'light',
        icon: 'â˜€ï¸'
      },
      dark: {
        name: 'midnight',
        mode: 'dark',
        icon: 'ğŸŒ™'
      },
      auto: {
        name: 'auto',
        mode: 'auto',
        icon: 'ğŸŒ—',
        getTheme: function() {
          const currentHour = new Date().getHours();
          return currentHour >= 18 || currentHour < 6 ? 'dark' : 'light';
        }
      }
    };

    // è·å–å½“å‰ä¸»é¢˜è®¾ç½®
    function getCurrentTheme() {
      // ä¼˜å…ˆçº§ï¼šlocalStorage > ç³»ç»Ÿåå¥½ > auto
      const savedTheme = localStorage.getItem('oceanpress-theme');
      if (savedTheme && themes[savedTheme]) {
        return savedTheme;
      }

      // æ£€æµ‹ç³»ç»Ÿåå¥½
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        return 'dark';
      }
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
        return 'light';
      }

      return 'auto';
    }

    // åº”ç”¨ä¸»é¢˜
    function applyTheme(themeName) {
      const theme = themes[themeName] || themes.auto;
      const actualTheme = themeName === 'auto' ? theme.getTheme() : themeName;
      const themeConfig = themes[actualTheme];

      // è®¾ç½® CSS å˜é‡
      document.documentElement.setAttribute('data-theme-mode', themeConfig.mode);
      document.documentElement.setAttribute('data-light-theme', 'daylight');
      document.documentElement.setAttribute('data-dark-theme', 'midnight');

      // åŠ è½½å¯¹åº”çš„ CSS
      const themeStyle = document.getElementById('themeDefaultStyle');
      if (themeStyle) {
        themeStyle.href = 'https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/appearance/themes/' + themeConfig.name + '/theme.css?2.10.5';
      } else {
        // å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒ
        const link = document.createElement('link');
        link.id = 'themeDefaultStyle';
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/appearance/themes/' + themeConfig.name + '/theme.css?2.10.5';
        document.head.appendChild(link);
      }

      // æ›´æ–°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
      updateThemeToggle(themeName);

      // ä¿å­˜åˆ° localStorage
      localStorage.setItem('oceanpress-theme', themeName);

      // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
      window.dispatchEvent(new CustomEvent('oceanpress-theme-changed', {
        detail: { theme: themeName, actualTheme: actualTheme }
      }));
    }

    // åˆ›å»ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®
    function createThemeToggle() {
      const toggle = document.createElement('div');
      toggle.id = 'oceanpress-theme-toggle';
      toggle.innerHTML = '<span class="theme-icon">ğŸŒ—</span><span class="theme-text">è‡ªåŠ¨</span>';
      toggle.addEventListener('click', toggleTheme);
      (document.querySelector('[data-type="NodeDocument"]')||document.body).appendChild(toggle);
    }

    // æ›´æ–°ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
    function updateThemeToggle(themeName) {
      const toggle = document.getElementById('oceanpress-theme-toggle');
      if (!toggle) return;

      const theme = themes[themeName] || themes.auto;
      toggle.innerHTML = '<span class="theme-icon">' + theme.icon + '</span><span class="theme-text">' +
        (themeName === 'auto' ? 'è‡ªåŠ¨' : (themeName === 'dark' ? 'æ·±è‰²' : 'æµ…è‰²')) + '</span>';
    }

    // åˆ‡æ¢ä¸»é¢˜
    function toggleTheme() {
      const currentTheme = getCurrentTheme();
      const themeOrder = ['auto', 'light', 'dark'];
      const currentIndex = themeOrder.indexOf(currentTheme);
      const nextIndex = (currentIndex + 1) % themeOrder.length;
      const nextTheme = themeOrder[nextIndex];

      applyTheme(nextTheme);
    }

    // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
    if (window.matchMedia) {
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        const currentTheme = getCurrentTheme();
        if (currentTheme === 'auto') {
          applyTheme('auto');
        }
      });
    }

    // ç›‘å¬è‡ªå®šä¹‰ä¸»é¢˜å˜åŒ–äº‹ä»¶ï¼ˆç”¨äºä¾§è¾¹æ ç­‰ç»„ä»¶ï¼‰
    window.addEventListener('oceanpress-theme-changed', function(e) {
      // è¿™é‡Œå¯ä»¥æ·»åŠ å…¶ä»–ç»„ä»¶éœ€è¦å“åº”ä¸»é¢˜å˜åŒ–çš„é€»è¾‘
      console.log('Theme changed to:', e.detail);
    });

    // åˆå§‹åŒ–ä¸»é¢˜
    function initTheme() {
      const themeName = getCurrentTheme();
      const theme = themes[themeName] || themes.auto;
      const actualTheme = themeName === 'auto' ? theme.getTheme() : themeName;
      const themeConfig = themes[actualTheme];

      // ç«‹å³è®¾ç½®åŸºç¡€ä¸»é¢˜ï¼Œé¿å…é—ªçƒ
      document.documentElement.setAttribute('data-theme-mode', themeConfig.mode);
      document.documentElement.setAttribute('data-light-theme', 'daylight');
      document.documentElement.setAttribute('data-dark-theme', 'midnight');

      // åˆ›å»ºä¸»é¢˜åˆ‡æ¢æŒ‰é’®
      createThemeToggle();

      // åº”ç”¨å®Œæ•´ä¸»é¢˜
      applyTheme(themeName);
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initTheme);
    } else {
      initTheme();
    }
  })();
  </script>
  <link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/appearance/oceanpress.css"/>
  <title>Automatic translation of documents-the combination of expr plugin and aichat plugin technology</title>
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Automatic translation of documents-the combination of expr plugin and aichat plugin technology",
  "description": "Automatic translation of documents-the combination of expr plugin and aichat plugin technology ä¸­æ–‡ç‰ˆ : è‡ªåŠ¨ç¿»è¯‘æ–‡æ¡£-expræ’ä»¶å’Œaichatæ’ä»¶çš„ç»„åˆæŠ€ Current article's English transl...",
  "keywords": "block, expr, const, plugin, sourceid, updated, translated, aichat",
  "datePublished": "2025-03-08T19:15:32Z",
  "dateModified": "2025-03-08T19:44:06Z",
  "author": {
    "@type": "Person",
    "name": "å´®ç”Ÿ",
    "url": ""
  },
  "publisher": {
    "@type": "Organization",
    "name": "OceanPress",
    "logo": {
      "@type": "ImageObject",
      "url": "/assets/logo.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/index/Automatic translation of documents-the combination of expr plugin and aichat plugin technology.html"
  },
  "wordCount": 2450,
  "articleSection": "æŠ€æœ¯æ–‡æ¡£",
  "inLanguage": "zh-CN"
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "index",
      "item": "/index.html"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Automatic translation of documents-the combination of expr plugin and aichat plugin technology",
      "item": "/index/Automatic translation of documents-the combination of expr plugin and aichat plugin technology.html"
    }
  ]
}
</script>
</head>
<body>
  <div class="header-container">
  <a href="/" class="home-button">é¦–é¡µ</a>
  <div id="search"></div>
</div>

  <div class="protyle-wysiwyg protyle-wysiwyg--attr" id="preview">
  <div id="oceanpress-left-sidebar">
    
    <div id="oceanpress-doctree"></div>
           <script src="./../__oceanpress/docTree.js" async></script>
  </div>
  <div style="min-height: 150px;" id="20250308191532-g9hkuca" data-node-id="20250308191532-g9hkuca" data-type="NodeDocument" updated="20250308194406" type="doc">

<h1 id="20250308191532-g9hkuca" data-node-id="20250308191532-g9hkuca" data-type="NodeDocument" updated="20250308194406" type="doc" data-type="NodeHeading" class="h1">Automatic translation of documents-the combination of expr plugin and aichat plugin technology</h1>
<div id="20250308191745-3cdsrl1" data-node-id="20250308191745-3cdsrl1" data-type="NodeParagraph" updated="20250308191800" class="p"><div spellcheck="false">ä¸­æ–‡ç‰ˆ :<span data-type="block-ref"   data-subtype="d"   data-id="20241228103033-h9y9bt3"><a href="./../index/è‡ªåŠ¨ç¿»è¯‘æ–‡æ¡£-expræ’ä»¶å’Œaichatæ’ä»¶çš„ç»„åˆæŠ€.html#20241228103033-h9y9bt3">è‡ªåŠ¨ç¿»è¯‘æ–‡æ¡£-expræ’ä»¶å’Œaichatæ’ä»¶çš„ç»„åˆæŠ€</a></span></div></div><div id="20250308191532-4mh62vx" data-node-id="20250308191532-4mh62vx" data-type="NodeSuperBlock" updated="20250308194406" class="sb" custom-ai-translated-updated="20250308194225" custom-expr="// éœ€è¦è¢«ç¿»è¯‘çš„å—(æ–‡æ¡£)çš„ id_esc_newline_const sourceId = '20241228103033-h9y9bt3';_esc_newline__esc_newline_const sourceAttr = await expr.util.api.getBlockAttrs(sourceId);_esc_newline_// è¡¨è¾¾å¼å—çš„å±æ€§_esc_newline_const blockAttr = await expr.util.api.getBlockAttrs(block.id);_esc_newline__esc_newline_// åªæ”¯æŒè‹±æ–‡å­—æ¯å’Œæ•°å­—ï¼Œä¸æ”¯æŒç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼_esc_newline_const updateFlag = 'custom-ai-translated-updated';_esc_newline__esc_newline_if (sourceAttr.updated === blockAttr[updateFlag]) &#123;_esc_newline_  // åŸæ–‡æ¡£æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥è¡¨è¾¾å¼å—çš„å†…å®¹ä¹Ÿä¸éœ€è¦æ›´æ–°_esc_newline_  return expr.flag.noOutput;_esc_newline_&#125; else &#123;_esc_newline_  const res = await expr.util.api.getBlockKramdown(sourceId);_esc_newline_  const kramdown = res ? res.kramdown : res;_esc_newline_  if (!kramdown) &#123;_esc_newline_    return expr.flag.noOutput;_esc_newline_  &#125;_esc_newline_  block.Attr=&#123; [updateFlag]: sourceAttr.updated &#125;_esc_newline_  return (_esc_newline_    '&#123;&#123;&#123;row\n' +_esc_newline_    (await aiChatPlugin.openaiAPI.aiç¿»è¯‘ä¸ºè‹±æ–‡(&#123; openai: aiChatPlugin.openaiAPI.openai &#125;, kramdown))_esc_newline_      .res +_esc_newline_    '\n&#125;&#125;&#125;'_esc_newline_  );_esc_newline_&#125;" custom-expr-value="&#123;&#123;&#123;row_esc_newline_Current article's English translation: ((20250308191532-g9hkuca 'Automatic translation of documents'))_esc_newline_&#123;: id=&quot;20250308191708-msc9c4g&quot; updated=&quot;20250308191735&quot;&#125;_esc_newline__esc_newline_## Introduction_esc_newline_&#123;: id=&quot;20241228103321-j2580bo&quot; updated=&quot;20241228103539&quot;&#125;_esc_newline__esc_newline_Sometimes, I have a need to translate articles into English for sharing on the English internet. Therefore, now I can use the aichat plugin to have AI help me translate documents, then use the expr plugin to automatically update English notes, and finally share my notes using ((20201121142503-ivwtfzg 'OceanPress')). A smooth combo is completed in one go._esc_newline_&#123;: id=&quot;20241228103330-1986rfk&quot; updated=&quot;20241228103536&quot;&#125;_esc_newline__esc_newline_## Implementation Method_esc_newline_&#123;: id=&quot;20241228103539-ru8wf4x&quot; updated=&quot;20250308192039&quot;&#125;_esc_newline__esc_newline_1. &#123;: id=&quot;20241228103617-xjuylym&quot; updated=&quot;20250308191340&quot;&#125;Install the latest version of the expr plugin_esc_newline_    &#123;: id=&quot;20241228103617-10ayh0y&quot; updated=&quot;20250308191340&quot;&#125;_esc_newline_2. &#123;: id=&quot;20241228103619-gbx6jem&quot; updated=&quot;20250308191344&quot;&#125;Install the latest version of the aichat plugin_esc_newline_    &#123;: id=&quot;20241228103619-d0yy0tc&quot; updated=&quot;20250308191344&quot;&#125;_esc_newline_&#123;: id=&quot;20241228103033-5meuyig&quot; updated=&quot;20250308191344&quot;&#125;_esc_newline__esc_newline_&#123;: id=&quot;20250306204056-lnh3hj6&quot; updated=&quot;20250306214628&quot;&#125;_esc_newline__esc_newline_Add the expr attribute to the block where the translated text needs to be output (hold down the shift key and click the block marker to open the custom attribute panel)._esc_newline_![image](assets/image-20250308191859-teuq6k1.png)_esc_newline_&#123;: id=&quot;20250306214629-u9lkg5t&quot; updated=&quot;20250308191941&quot;&#125;_esc_newline__esc_newline_The expression is as follows, and you need to modify the sourceId to the id of the original document (right-click the corresponding document &gt; copy &gt; id)_esc_newline_&#123;: id=&quot;20250306214641-u2cg1t2&quot; updated=&quot;20250308191412&quot;&#125;_esc_newline__esc_newline_```js_esc_newline_// The id of the block (document) to be translated_esc_newline_const sourceId = '20250306213356-ekvz9w9';_esc_newline__esc_newline_const sourceAttr = await expr.util.api.getBlockAttrs(sourceId);_esc_newline_// Attributes of the expression block_esc_newline_const blockAttr = await expr.util.api.getBlockAttrs(block.id);_esc_newline__esc_newline_// Only supports letters and numbers, does not support special characters and spaces_esc_newline_const updateFlag = 'custom-ai-translated-updated';_esc_newline__esc_newline_if (sourceAttr.updated === blockAttr[updateFlag]) &#123;_esc_newline_  // The original document has not been updated, so the content of the expression block does not need to be updated_esc_newline_  return expr.flag.noOutput;_esc_newline_&#125; else &#123;_esc_newline_  const res = await expr.util.api.getBlockKramdown(sourceId);_esc_newline_  const kramdown = res ? res.kramdown : res;_esc_newline_  if (!kramdown) &#123;_esc_newline_    return expr.flag.noOutput;_esc_newline_  &#125;_esc_newline_  block.Attr=&#123; [updateFlag]: sourceAttr.updated &#125;_esc_newline_  return (_esc_newline_    '&#123;&#123;&#123;row\n' +_esc_newline_    (await aiChatPlugin.openaiAPI.aiTranslateToEnglish(&#123; openai: aiChatPlugin.openaiAPI.openai &#125;, kramdown))_esc_newline_      .res +_esc_newline_    '\n&#125;&#125;&#125;'_esc_newline_  );_esc_newline_&#125;_esc_newline__esc_newline_```_esc_newline_&#123;: id=&quot;20250306214646-p58etpr&quot; style=&quot;line-height: 22px;&quot; updated=&quot;20250308191421&quot;&#125;_esc_newline__esc_newline_After the translation, if you update the original text, the corresponding translated expression will automatically synchronize updates at specific times._esc_newline_&#123;: id=&quot;20250308191425-qr0b88i&quot; updated=&quot;20250308191517&quot;&#125;_esc_newline__esc_newline_The expression block being executed will have a blinking blue border._esc_newline_&#123;: id=&quot;20250308191853-zr0zmx7&quot; updated=&quot;20250308192026&quot;&#125;_esc_newline__esc_newline_&#123;: id=&quot;20241228103033-h9y9bt3&quot; title=&quot;Automatic Document Translation - Combination Technique of expr Plugin and aichat Plugin&quot; type=&quot;doc&quot; updated=&quot;20250308194225&quot;&#125;_esc_newline_&#125;&#125;&#125;" data-sb-layout="row"><div id="20250312103657-r061tn0" data-node-id="20250312103657-r061tn0" data-type="NodeParagraph" updated="20250308191735" class="p"><div spellcheck="false">Current article's English translation: <span data-type="block-ref"   data-subtype="d"   data-id="20250308191532-g9hkuca"><a href="./../index/Automatic translation of documents-the combination of expr plugin and aichat plugin technology.html#20250308191532-g9hkuca">Automatic translation of documents-the combination of expr plugin and aichat plugin technology</a></span></div></div><h2 id="20250312103657-1gunzlo" data-node-id="20250312103657-1gunzlo" data-type="NodeHeading" updated="20241228103539" data-subtype="h2" class="h2">Introduction</h2><div id="20250312103657-v9zi46i" data-node-id="20250312103657-v9zi46i" data-type="NodeParagraph" updated="20241228103536" class="p"><div spellcheck="false">Sometimes, I have a need to translate articles into English for sharing on the English internet. Therefore, now I can use the aichat plugin to have AI help me translate documents, then use the expr plugin to automatically update English notes, and finally share my notes using <span data-type="block-ref"   data-subtype="d"   data-id="20201121142503-ivwtfzg"><a href="./../æƒ³æ³•/é¡¹ç›®/OceanPress.html#20201121142503-ivwtfzg">OceanPress</a></span>. A smooth combo is completed in one go.</div></div><h2 id="20250312103657-mtrd075" data-node-id="20250312103657-mtrd075" data-type="NodeHeading" updated="20250308192039" data-subtype="h2" class="h2">Implementation Method</h2><div id="20250312103657-6wv9qb3" data-node-id="20250312103657-6wv9qb3" data-type="NodeList" updated="20250308191344" data-subtype="o" class="list"><div id="20250312103657-8b6tl00" data-node-id="20250312103657-8b6tl00" data-type="NodeListItem" updated="20250308191340" data-subtype="o" class="li" data-marker="1.">
        <div class="protyle-action">
          1.
        </div>
        <div id="20250312103657-ash9s1j" data-node-id="20250312103657-ash9s1j" data-type="NodeParagraph" updated="20250308191340" class="p"><div spellcheck="false">Install the latest version of the expr plugin</div></div>
      </div><div id="20250312103657-hgporek" data-node-id="20250312103657-hgporek" data-type="NodeListItem" updated="20250308191344" data-subtype="o" class="li" data-marker="2.">
        <div class="protyle-action">
          2.
        </div>
        <div id="20250312103657-gyf6h9n" data-node-id="20250312103657-gyf6h9n" data-type="NodeParagraph" updated="20250308191344" class="p"><div spellcheck="false">Install the latest version of the aichat plugin</div></div>
      </div></div><div id="20250312103657-j8o2h41" data-node-id="20250312103657-j8o2h41" data-type="NodeParagraph" updated="20250306214628" class="p"><div spellcheck="false"></div></div><div id="20250312103657-uk0befo" data-node-id="20250312103657-uk0befo" data-type="NodeParagraph" updated="20250308191941" class="p"><div spellcheck="false">Add the expr attribute to the block where the translated text needs to be output (hold down the shift key and click the block marker to open the custom attribute panel).
â€‹<span data-type="NodeImage" class="img" style="">
  <img
    src="./../assets/image-20250308191859-teuq6k1.png"
    data-src="./../assets/image-20250308191859-teuq6k1.png"
    title=""
    style=""
    loading="lazy"
  />
  <span class="protyle-action__title"></span></span>â€‹</div></div><div id="20250312103657-59a3qtv" data-node-id="20250312103657-59a3qtv" data-type="NodeParagraph" updated="20250308191412" class="p"><div spellcheck="false">The expression is as follows, and you need to modify the sourceId to the id of the original document (right-click the corresponding document > copy > id)</div></div><div id="20250312103657-zzm85cz" data-node-id="20250312103657-zzm85cz" data-type="NodeCodeBlock" updated="20250308191421" class="code-block" style="line-height: 22px;">
          <div class="protyle-action">
            <span class="protyle-action--first protyle-action__language">js</span>
            <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
          </div>
          <div class="hljs" spellcheck="false">// The id of the block (document) to be translated
const sourceId = '20250306213356-ekvz9w9';

const sourceAttr = await expr.util.api.getBlockAttrs(sourceId);
// Attributes of the expression block
const blockAttr = await expr.util.api.getBlockAttrs(block.id);

// Only supports letters and numbers, does not support special characters and spaces
const updateFlag = 'custom-ai-translated-updated';

if (sourceAttr.updated === blockAttr[updateFlag]) {
  // The original document has not been updated, so the content of the expression block does not need to be updated
  return expr.flag.noOutput;
} else {
  const res = await expr.util.api.getBlockKramdown(sourceId);
  const kramdown = res ? res.kramdown : res;
  if (!kramdown) {
    return expr.flag.noOutput;
  }
  block.Attr={ [updateFlag]: sourceAttr.updated }
  return (
    '{{{row\n' +
    (await aiChatPlugin.openaiAPI.aiTranslateToEnglish({ openai: aiChatPlugin.openaiAPI.openai }, kramdown))
      .res +
    '\n}}}'
  );
}

</div>
        </div><div id="20250312103657-mbnag4r" data-node-id="20250312103657-mbnag4r" data-type="NodeParagraph" updated="20250308191517" class="p"><div spellcheck="false">After the translation, if you update the original text, the corresponding translated expression will automatically synchronize updates at specific times.</div></div><div id="20250312103657-tfbt5nz" data-node-id="20250312103657-tfbt5nz" data-type="NodeParagraph" updated="20250308192026" class="p"><div spellcheck="false">The expression block being executed will have a blinking blue border.</div></div></div></div>
  <div id="oceanpress-right-sidebar"></div>
</div>
  <script src="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/appearance/icons/material/icon.js?2.10.5"></script>
  <script src="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/stage/build/export/protyle-method.js?2.10.5"></script>
  <script src="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/stage/protyle/js/lute/lute.min.js?2.10.5"></script>
  <script>
    window.siyuan = {
      config: {
        appearance: {
          mode: document.documentElement.getAttribute('data-theme-mode') === 'dark' ? 1 : 0,//ä¸»é¢˜ æ˜äº®=0 æš—é»‘=1
          codeBlockThemeDark: "base16/dracula",
          codeBlockThemeLight: "github",
        },
        editor: {
          codeLineWrap: true,
          codeLigatures: false,
          plantUMLServePath: "https://www.plantuml.com/plantuml/svg/~1",
          codeSyntaxHighlightLineNum: true,
          katexMacros: JSON.stringify({}),
        },
      },
      languages: { copy: "å¤åˆ¶" },
    };
    const cdn = "https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@1.0.12/apps/frontend/public/notebook/stage/protyle";
    const previewElement = document.getElementById("preview");

    Protyle.highlightRender(previewElement, cdn);
    Protyle.mathRender(previewElement, cdn, false);
    Protyle.mermaidRender(previewElement, cdn);
    Protyle.flowchartRender(previewElement, cdn);
    Protyle.graphvizRender(previewElement, cdn);
    Protyle.chartRender(previewElement, cdn);
    Protyle.mindmapRender(previewElement, cdn);
    Protyle.abcRender(previewElement, cdn);
    Protyle.htmlRender(previewElement);
    Protyle.plantumlRender(previewElement, cdn);
    document.querySelectorAll(".protyle-action__copy").forEach((item) => {
      item.addEventListener("click", (event) => {
        navigator.clipboard.writeText(
          item.parentElement.nextElementSibling.textContent.trimEnd(),
        );
        event.preventDefault();
        event.stopPropagation();
      });
    });
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7181140659254262"
crossorigin="anonymous"></script><footer class="theme-aware-footer">
  <p>
    æŠ€æœ¯æ”¯æŒï¼š
    <a target="_blank" href="https://github.com/2234839/oceanPress_js">OceanPress</a> |
    <a target="_blank" href="https://heartstack.space/user/%E5%AD%90%E8%99%9A/posts">å´®ç”Ÿï¼ˆå­è™šï¼‰</a> |
    <a target="_blank" href="//beian.miit.gov.cn">æ¹˜ICPå¤‡18021783å·-1</a>
  </p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript">
  docsearch({
    appId: "UBOM0V691R",
    apiKey: "0c572ae8b8611d29477570967f44c3cf",
    indexName: "shenzilong",
    insights: true, 
    container: '#search',
    debug: false
  });
</script>

</body>
</html>