<!DOCTYPE html>
<html lang="zh_CN" data-theme-mode="light" data-light-theme="daylight" data-dark-theme="midnight">
<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="stylesheet" type="text/css" id="baseStyle" href="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/stage/build/export/base.css?2.10.5"/>
  <script>
  function isNightTime() {
    const currentHour = new Date().getHours();
    return currentHour >= 18 || currentHour < 6;
  }
  document.write('<link rel="stylesheet" type="text/css" id="themeDefaultStyle" href="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/appearance/themes/'+(isNightTime()?'midnight':'daylight')+'/theme.css?2.10.5"/>');
  </script>
  <link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/appearance/oceanpress.css"/>
  <title>最近更新.rss.xml</title>
</head>
<body>
  <div id="search"></div>
  <div class="protyle-wysiwyg protyle-wysiwyg--attr" id="preview">
  <div style="min-height: 150px;" id="20210606154842-rgtj4rm" data-node-id="20210606154842-rgtj4rm" data-type="NodeDocument" updated="20240619103229" data-subtype="h1" class="h1" scroll="&#123;&quot;rootId&quot;:&quot;20210606154842-rgtj4rm&quot;,&quot;startId&quot;:&quot;20210606154842-jah9dt8&quot;,&quot;endId&quot;:&quot;20210606160324-57c0iql&quot;,&quot;scrollTop&quot;:0,&quot;focusId&quot;:&quot;20210606154842-jah9dt8&quot;,&quot;focusStart&quot;:0,&quot;focusEnd&quot;:0&#125;" type="doc"></div><h1 id="20210606154842-rgtj4rm" data-node-id="20210606154842-rgtj4rm" data-type="NodeDocument" updated="20240619103229" data-subtype="h1" class="h1" scroll="&#123;&quot;rootId&quot;:&quot;20210606154842-rgtj4rm&quot;,&quot;startId&quot;:&quot;20210606154842-jah9dt8&quot;,&quot;endId&quot;:&quot;20210606160324-57c0iql&quot;,&quot;scrollTop&quot;:0,&quot;focusId&quot;:&quot;20210606154842-jah9dt8&quot;,&quot;focusStart&quot;:0,&quot;focusEnd&quot;:0&#125;" type="doc" data-type="NodeHeading" class="h1">最近更新.rss.xml</h1><div id="20210606154842-jah9dt8" data-node-id="20210606154842-jah9dt8" data-type="NodeBlockQueryEmbed" updated="20240619103229" style="height: 9998px;" data-type="NodeBlockquote" class="bq"><h2 id="20240831151810-wcm9b6a" data-node-id="20240831151810-wcm9b6a" data-type="NodeHeading" updated="20240831152355" data-subtype="h2" class="h2">使用情况</h2>
<div id="20240831151816-je4r9a3" data-node-id="20240831151816-je4r9a3" data-type="NodeParagraph" updated="20240831151915" class="p"><div spellcheck="false">llrt 的运行速度比 node 还是慢了许多，在我这个场景下它比 node 要慢上两倍，gc 的运行速度也要慢许多。</div></div>
<div id="20240831152323-smkt5hr" data-node-id="20240831152323-smkt5hr" data-type="NodeParagraph" updated="20240831152355" class="p"><div spellcheck="false">但初始内存占用和启动速度是碾压 node 的。</div></div>
<div id="20240831151915-jffhsdl" data-node-id="20240831151915-jffhsdl" data-type="NodeParagraph" updated="20240831152258" class="p"><div spellcheck="false">由于运行时还不是特别完善的问题，很容易踩坑，所以除非你急需压缩 js 的运行内存占用/冷启动速度或者和我一样就是想要这么做，还是建议直接使用 node 吧。</div></div>
<div id="20240831152226-k6hu20d" data-node-id="20240831152226-k6hu20d" data-type="NodeParagraph" updated="20240831152226" class="p"><div spellcheck="false"></div></div><div id="20240831152323-smkt5hr" data-node-id="20240831152323-smkt5hr" data-type="NodeParagraph" updated="20240831152355" class="p"><div spellcheck="false">但初始内存占用和启动速度是碾压 node 的。</div></div><div id="20240831151915-jffhsdl" data-node-id="20240831151915-jffhsdl" data-type="NodeParagraph" updated="20240831152258" class="p"><div spellcheck="false">由于运行时还不是特别完善的问题，很容易踩坑，所以除非你急需压缩 js 的运行内存占用/冷启动速度或者和我一样就是想要这么做，还是建议直接使用 node 吧。</div></div><div id="20240831152226-k6hu20d" data-node-id="20240831152226-k6hu20d" data-type="NodeParagraph" updated="20240831152226" class="p"><div spellcheck="false"></div></div><div id="20240831151816-je4r9a3" data-node-id="20240831151816-je4r9a3" data-type="NodeParagraph" updated="20240831151915" class="p"><div spellcheck="false">llrt 的运行速度比 node 还是慢了许多，在我这个场景下它比 node 要慢上两倍，gc 的运行速度也要慢许多。</div></div><h3 id="20240831151442-rhwwudj" data-node-id="20240831151442-rhwwudj" data-type="NodeHeading" updated="20240831151811" data-subtype="h3" class="h3">2. Dockerfile</h3>
<div id="20240831151500-5cumea7" data-node-id="20240831151500-5cumea7" data-type="NodeParagraph" updated="20240831151643" class="p"><div spellcheck="false">得益于 llrt ，可以不用依赖任何环境，直接使用 <span data-type="code">FROM scratch</span>​ 来得到最小的docker镜像体积</div></div>
<div id="20240831151644-nqlvb9k" data-node-id="20240831151644-nqlvb9k" data-type="NodeCodeBlock" updated="20240831151701" class="code-block" style="line-height: 22px;">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">dockerfile</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">FROM scratch
WORKDIR /home/
COPY dist_backend/app.lrt /home/app.lrt
COPY llrt /home/llrt
COPY dist/ /home/dist/
CMD ["/home/llrt", "/home/app.lrt"]
</div>
      </div>
<div id="20240831151702-kcntpeu" data-node-id="20240831151702-kcntpeu" data-type="NodeParagraph" updated="20240831151803" class="p"><div spellcheck="false">再经过 docker 的压缩后就得到了 3.78MB 这个数字。</div></div><div id="20240831151702-kcntpeu" data-node-id="20240831151702-kcntpeu" data-type="NodeParagraph" updated="20240831151803" class="p"><div spellcheck="false">再经过 docker 的压缩后就得到了 3.78MB 这个数字。</div></div><div id="20240831151644-nqlvb9k" data-node-id="20240831151644-nqlvb9k" data-type="NodeCodeBlock" updated="20240831151701" class="code-block" style="line-height: 22px;">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">dockerfile</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">FROM scratch
WORKDIR /home/
COPY dist_backend/app.lrt /home/app.lrt
COPY llrt /home/llrt
COPY dist/ /home/dist/
CMD ["/home/llrt", "/home/app.lrt"]
</div>
      </div><div id="20240831151500-5cumea7" data-node-id="20240831151500-5cumea7" data-type="NodeParagraph" updated="20240831151643" class="p"><div spellcheck="false">得益于 llrt ，可以不用依赖任何环境，直接使用 <span data-type="code">FROM scratch</span>​ 来得到最小的docker镜像体积</div></div><h2 id="20240831151238-gl82fhw" data-node-id="20240831151238-gl82fhw" data-type="NodeHeading" updated="20240831151446" data-subtype="h2" class="h2">打包微小体积的 docker 镜像</h2><h3 id="20240831151315-ovhm3h0" data-node-id="20240831151315-ovhm3h0" data-type="NodeHeading" updated="20240831151446" data-subtype="h3" class="h3">1. 代码打包</h3>
<div id="20240831151325-7een63u" data-node-id="20240831151325-7een63u" data-type="NodeParagraph" updated="20240831151351" class="p"><div spellcheck="false">这方面我使用的是 tsup 将 ts 源码打包为一个 js 文件。</div></div>
<div id="20240831151351-7po9zwn" data-node-id="20240831151351-7po9zwn" data-type="NodeParagraph" updated="20240831151441" class="p"><div spellcheck="false">然后使用 llrt compile 命令将 js 文件编译为 .lrt 文件（这一步也能减少差不多 30%的体积）</div></div><div id="20240831151351-7po9zwn" data-node-id="20240831151351-7po9zwn" data-type="NodeParagraph" updated="20240831151441" class="p"><div spellcheck="false">然后使用 llrt compile 命令将 js 文件编译为 .lrt 文件（这一步也能减少差不多 30%的体积）</div></div><div id="20240831151325-7een63u" data-node-id="20240831151325-7een63u" data-type="NodeParagraph" updated="20240831151351" class="p"><div spellcheck="false">这方面我使用的是 tsup 将 ts 源码打包为一个 js 文件。</div></div><h2 id="20240831150202-ugmw1np" data-node-id="20240831150202-ugmw1np" data-type="NodeHeading" updated="20240831151238" data-subtype="h2" class="h2">迁移遇到的问题</h2>
<div id="20240831150309-jctqw3s" data-node-id="20240831150309-jctqw3s" data-type="NodeParagraph" updated="20240831151233" class="p"><div spellcheck="false">主要问题是 llrt 没有提供 http 模块（tixiki.js 也是）, 幸运的是它提供了 net 模块</div></div>
<div id="20240831150650-8pkxgt8" data-node-id="20240831150650-8pkxgt8" data-type="NodeParagraph" updated="20240831150831" class="p"><div spellcheck="false">所以我基于 net.createServer 手搓了一个<a href="https://github.com/2234839/web-font/blob/new/backend/server/tcp_server.ts">简易 http 服务</a>和洋葱路由 <a href="https://github.com/2234839/web-font/blob/new/backend/server/server.ts">server.ts</a> 。</div></div>
<div id="20240831150814-tlatlw8" data-node-id="20240831150814-tlatlw8" data-type="NodeParagraph" updated="20240831151031" class="p"><div spellcheck="false">这期间还发现了 llrt 一个  cpu 占用异常：<a href="https://github.com/awslabs/llrt/issues/546">https://github.com/awslabs/llrt/issues/546</a></div></div><div id="20240831150309-jctqw3s" data-node-id="20240831150309-jctqw3s" data-type="NodeParagraph" updated="20240831151233" class="p"><div spellcheck="false">主要问题是 llrt 没有提供 http 模块（tixiki.js 也是）, 幸运的是它提供了 net 模块</div></div><div id="20240831150814-tlatlw8" data-node-id="20240831150814-tlatlw8" data-type="NodeParagraph" updated="20240831151031" class="p"><div spellcheck="false">这期间还发现了 llrt 一个  cpu 占用异常：<a href="https://github.com/awslabs/llrt/issues/546">https://github.com/awslabs/llrt/issues/546</a></div></div><div id="20240831150650-8pkxgt8" data-node-id="20240831150650-8pkxgt8" data-type="NodeParagraph" updated="20240831150831" class="p"><div spellcheck="false">所以我基于 net.createServer 手搓了一个<a href="https://github.com/2234839/web-font/blob/new/backend/server/tcp_server.ts">简易 http 服务</a>和洋葱路由 <a href="https://github.com/2234839/web-font/blob/new/backend/server/server.ts">server.ts</a> 。</div></div><h2 id="20240831150235-v0favn7" data-node-id="20240831150235-v0favn7" data-type="NodeHeading" updated="20240831150359" data-subtype="h2" class="h2">选择 js 运行时 （<a href="https://github.com/awslabs/llrt">llrt</a>）</h2>
<div id="20240831145355-rmiaq5z" data-node-id="20240831145355-rmiaq5z" data-type="NodeParagraph" updated="20240831145555" class="p"><div spellcheck="false">要实现这么小的镜像肯定不能再使用 node 这种等级的 js 运行时了，现在最流行的轻量级 js 运行时可以锁定为 <a href="https://github.com/quickjs-zh/QuickJS">QuickJS</a></div></div>
<div id="20240831145555-duuyp6p" data-node-id="20240831145555-duuyp6p" data-type="NodeParagraph" updated="20240831145843" class="p"><div spellcheck="false">我要迁移的项目是我之前写的一个字体裁剪工具  <a href="https://github.com/2234839/web-font">web-font</a> , 它除了纯 js 的部分外还涉及到文件读写和 http server 部分的 api ，QuickJS 作为纯粹的解释器是没有这方面的 api 的。</div></div>
<div id="20240831145844-incy3ww" data-node-id="20240831145844-incy3ww" data-type="NodeParagraph" updated="20240831150123" class="p"><div spellcheck="false">现有的比较成熟的基于 QuickJS 实现的微型 js 运行时有 <a href="https://github.com/saghul/txiki.js">txiki.js</a> 和 <a href="https://github.com/awslabs/llrt">llrt</a> , 经过实践发现 llrt 可以完美运行在 docker 中 ，txiki.js 则没那么方便 （按照文档编译出来的 tjs 还会依赖其他库）</div></div>
<div id="20240831150126-8lrwkb5" data-node-id="20240831150126-8lrwkb5" data-type="NodeParagraph" updated="20240831150202" class="p"><div spellcheck="false">所以我选择使用 llrt 来作为运行时。</div></div><div id="20240831150126-8lrwkb5" data-node-id="20240831150126-8lrwkb5" data-type="NodeParagraph" updated="20240831150202" class="p"><div spellcheck="false">所以我选择使用 llrt 来作为运行时。</div></div><div id="20240831145844-incy3ww" data-node-id="20240831145844-incy3ww" data-type="NodeParagraph" updated="20240831150123" class="p"><div spellcheck="false">现有的比较成熟的基于 QuickJS 实现的微型 js 运行时有 <a href="https://github.com/saghul/txiki.js">txiki.js</a> 和 <a href="https://github.com/awslabs/llrt">llrt</a> , 经过实践发现 llrt 可以完美运行在 docker 中 ，txiki.js 则没那么方便 （按照文档编译出来的 tjs 还会依赖其他库）</div></div><div id="20240831145555-duuyp6p" data-node-id="20240831145555-duuyp6p" data-type="NodeParagraph" updated="20240831145843" class="p"><div spellcheck="false">我要迁移的项目是我之前写的一个字体裁剪工具  <a href="https://github.com/2234839/web-font">web-font</a> , 它除了纯 js 的部分外还涉及到文件读写和 http server 部分的 api ，QuickJS 作为纯粹的解释器是没有这方面的 api 的。</div></div><div id="20240831145355-rmiaq5z" data-node-id="20240831145355-rmiaq5z" data-type="NodeParagraph" updated="20240831145555" class="p"><div spellcheck="false">要实现这么小的镜像肯定不能再使用 node 这种等级的 js 运行时了，现在最流行的轻量级 js 运行时可以锁定为 <a href="https://github.com/quickjs-zh/QuickJS">QuickJS</a></div></div><div id="20240831145328-hdr2r92" data-node-id="20240831145328-hdr2r92" data-type="NodeParagraph" updated="20240831145352" class="p"><div spellcheck="false"><a href="https://hub.docker.com/layers/llej0/web-font/latest/images/sha256-ebb8bb18d33844f27ca02d632c2ebf584435fffae28be2c9416baa86a8de45be?context=repo">https://hub.docker.com/layers/llej0/web-font/latest</a></div></div><div id="20240831145324-4hncekq" data-node-id="20240831145324-4hncekq" data-type="NodeParagraph" updated="20240831145339" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" parent-style="width: 632px;" style="width: 622px;" style="width: 632px;">
<img
  src="./../../assets/image-20240831145324-mzsh9nq.png"
  data-src="./../../assets/image-20240831145324-mzsh9nq.png"
  title=""
  style="width: 622px;"
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><div id="20240831144928-35sg08q" data-node-id="20240831144928-35sg08q" data-type="NodeParagraph" updated="20240831145306" class="p"><div spellcheck="false">但这三个运行时的打包体积都不小，在精简的情况下也在 50 mb 以上，我在这里记录一下我是如何将一个原来使用 node 开发的服务迁移为 3.78MB 的 docker 镜像。</div></div><div id="20240831144820-k5k4jjf" data-node-id="20240831144820-k5k4jjf" data-type="NodeParagraph" updated="20240831144927" class="p"><div spellcheck="false">在服务端一般使用 node 来运行 js ，除了 node 外流行的还有 bun/deno。</div></div><h2 id="20240818115630-dorzf4t" data-node-id="20240818115630-dorzf4t" data-type="NodeHeading" updated="20240818115749" data-subtype="h2" class="h2">重构实现</h2>
<div id="20240818115642-g0u3fpc" data-node-id="20240818115642-g0u3fpc" data-type="NodeParagraph" updated="20240818115713" class="p"><div spellcheck="false">我看上了 llrt 的小体积，于是实现了一版支持llrt 的</div></div>
<div id="20240818115714-3dlgkdz" data-node-id="20240818115714-3dlgkdz" data-type="NodeParagraph" updated="20240818115730" class="p"><div spellcheck="false">在速度方面，比node慢了足足一倍</div></div>
<div id="20240818115749-nnjzgg3" data-node-id="20240818115749-nnjzgg3" data-type="NodeParagraph" updated="20240818115749" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" parent-style="width: 472px;" style="width: 462px;" style="width: 472px;">
<img
  src="./../../assets/image-20240818115749-2tn66zl.png"
  data-src="./../../assets/image-20240818115749-2tn66zl.png"
  title=""
  style="width: 462px;"
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><div id="20240818115749-nnjzgg3" data-node-id="20240818115749-nnjzgg3" data-type="NodeParagraph" updated="20240818115749" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" parent-style="width: 472px;" style="width: 462px;" style="width: 472px;">
<img
  src="./../../assets/image-20240818115749-2tn66zl.png"
  data-src="./../../assets/image-20240818115749-2tn66zl.png"
  title=""
  style="width: 462px;"
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><div id="20240818115714-3dlgkdz" data-node-id="20240818115714-3dlgkdz" data-type="NodeParagraph" updated="20240818115730" class="p"><div spellcheck="false">在速度方面，比node慢了足足一倍</div></div><div id="20240818115642-g0u3fpc" data-node-id="20240818115642-g0u3fpc" data-type="NodeParagraph" updated="20240818115713" class="p"><div spellcheck="false">我看上了 llrt 的小体积，于是实现了一版支持llrt 的</div></div><div id="20240818115635-0xf5sgo" data-node-id="20240818115635-0xf5sgo" data-type="NodeCodeBlock" updated="20240808092645" data-subtype="echarts" class="render-node" data-content="{
  &quot;xAxis&quot;: {
    &quot;type&quot;: &quot;category&quot;,
    &quot;boundaryGap&quot;: false,
    &quot;data&quot;: [
      &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;
    ]
  },
  &quot;yAxis&quot;: {
    &quot;type&quot;: &quot;value&quot;
  },
  &quot;series&quot;: [
    { 
        &quot;data&quot;: [ 6, 932, 901, 934, 1290, 1330, 1320 ],
      &quot;type&quot;: &quot;line&quot;,
      &quot;areaStyle&quot;: {}
    }
  ]
}">
        <div spin="1"></div>
        <div class="protyle-attr" contenteditable="false"></div>
      </div><div id="20240818115629-lai7b71" data-node-id="20240818115629-lai7b71" data-type="NodeParagraph" updated="20240818115629" class="p"><div spellcheck="false"><a href="https://github.com/2234839/web-font">webfont</a></div></div><div id="20240818115516-wt7rukz" data-node-id="20240818115516-wt7rukz" data-type="NodeParagraph" updated="20240818115523" class="p"><div spellcheck="false"><span data-type="block-ref" data-subtype="d" data-id="20240818115523-hf23y5f"><a href="./../../other/我的开源项目/webfont.html#20240818115523-hf23y5f">webfont</a></span></div></div><div id="20240808094525-hjmfusi" data-node-id="20240808094525-hjmfusi" data-type="NodeBlockquote" updated="20240818115506" class="bq" custom-expr="const data_a = (await expr.exprEvalByID(&quot;20240808094354-xiq54n9&quot;)) * 3_esc_newline__esc_newline_return `&gt; \`\`\`echarts_esc_newline_&gt; &#123;_esc_newline_&gt;   &quot;xAxis&quot;: &#123;_esc_newline_&gt;     &quot;type&quot;: &quot;category&quot;,_esc_newline_&gt;     &quot;boundaryGap&quot;: false,_esc_newline_&gt;     &quot;data&quot;: [_esc_newline_&gt;       &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;_esc_newline_&gt;     ]_esc_newline_&gt;   &#125;,_esc_newline_&gt;   &quot;yAxis&quot;: &#123;_esc_newline_&gt;     &quot;type&quot;: &quot;value&quot;_esc_newline_&gt;   &#125;,_esc_newline_&gt;   &quot;series&quot;: [_esc_newline_&gt;     &#123; _esc_newline_&gt;         &quot;data&quot;: [ $&#123;data_a&#125;, 932, 901, 934, 1290, 1330, 1320 ],_esc_newline_&gt;       &quot;type&quot;: &quot;line&quot;,_esc_newline_&gt;       &quot;areaStyle&quot;: &#123;&#125;_esc_newline_&gt;     &#125;_esc_newline_&gt;   ]_esc_newline_&gt; &#125;_esc_newline_&gt; \`\`\`_esc_newline_&gt; &#123;: id=&quot;20240808092645-7leeodx&quot; updated=&quot;20240808092645&quot;&#125;_esc_newline_&gt;`_esc_newline_" custom-expr-value="&gt; ```echarts_esc_newline_&gt; &#123;_esc_newline_&gt;   &quot;xAxis&quot;: &#123;_esc_newline_&gt;     &quot;type&quot;: &quot;category&quot;,_esc_newline_&gt;     &quot;boundaryGap&quot;: false,_esc_newline_&gt;     &quot;data&quot;: [_esc_newline_&gt;       &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;_esc_newline_&gt;     ]_esc_newline_&gt;   &#125;,_esc_newline_&gt;   &quot;yAxis&quot;: &#123;_esc_newline_&gt;     &quot;type&quot;: &quot;value&quot;_esc_newline_&gt;   &#125;,_esc_newline_&gt;   &quot;series&quot;: [_esc_newline_&gt;     &#123; _esc_newline_&gt;         &quot;data&quot;: [ 6, 932, 901, 934, 1290, 1330, 1320 ],_esc_newline_&gt;       &quot;type&quot;: &quot;line&quot;,_esc_newline_&gt;       &quot;areaStyle&quot;: &#123;&#125;_esc_newline_&gt;     &#125;_esc_newline_&gt;   ]_esc_newline_&gt; &#125;_esc_newline_&gt; ```_esc_newline_&gt; &#123;: id=&quot;20240808092645-7leeodx&quot; updated=&quot;20240808092645&quot;&#125;_esc_newline_&gt;"><div id="20240818115635-0xf5sgo" data-node-id="20240818115635-0xf5sgo" data-type="NodeCodeBlock" updated="20240808092645" data-subtype="echarts" class="render-node" data-content="{
  &quot;xAxis&quot;: {
    &quot;type&quot;: &quot;category&quot;,
    &quot;boundaryGap&quot;: false,
    &quot;data&quot;: [
      &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;
    ]
  },
  &quot;yAxis&quot;: {
    &quot;type&quot;: &quot;value&quot;
  },
  &quot;series&quot;: [
    { 
        &quot;data&quot;: [ 6, 932, 901, 934, 1290, 1330, 1320 ],
      &quot;type&quot;: &quot;line&quot;,
      &quot;areaStyle&quot;: {}
    }
  ]
}">
        <div spin="1"></div>
        <div class="protyle-attr" contenteditable="false"></div>
      </div></div><div id="20240714094221-fq461ss" data-node-id="20240714094221-fq461ss" data-type="NodeParagraph" updated="20240818115506" class="p" custom-expr="(await expr.exprEvalByID(&quot;20240714094026-1oid1cy&quot;)) * 3" custom-expr-value="9"><div spellcheck="false">9</div></div><div id="20240605121837-fj7005y" data-node-id="20240605121837-fj7005y" data-type="NodeParagraph" updated="20240818115505" class="p" custom-expr="block.box + &quot;3333333333333333333333333333333333333333333333333333333333333333333333333333333333&quot;" custom-expr-value="20210816161940-zo21go13333333333333333333333333333333333333333333333333333333333333333333333333333333333" style="background-color: var(--b3-font-background3); color: var(--b3-font-color6); width: 25%; flex: 0 0 auto;"><div spellcheck="false">20210816161940-zo21go13333333333333333333333333333333333333333333333333333333333333333333333333333333333</div></div><div id="20240808093944-kvaqkp7" data-node-id="20240808093944-kvaqkp7" data-type="NodeBlockquote" updated="20240818115505" class="bq" custom-expr=" &quot;&gt; ```echarts\n&gt; &#123;\n&gt;   \&quot;xAxis\&quot;: &#123;\n&gt;     \&quot;type\&quot;: \&quot;category\&quot;,\n&gt;     \&quot;boundaryGap\&quot;: false,\n&gt;     \&quot;data\&quot;: [\n&gt;       \&quot;Mon\&quot;, \&quot;Tue\&quot;, \&quot;Wed\&quot;, \&quot;Thu\&quot;, \&quot;Fri\&quot;, \&quot;Sat\&quot;, \&quot;Sun\&quot;\n&gt;     ]\n&gt;   &#125;,\n&gt;   \&quot;yAxis\&quot;: &#123;\n&gt;     \&quot;type\&quot;: \&quot;value\&quot;\n&gt;   &#125;,\n&gt;   \&quot;series\&quot;: [\n&gt;     &#123; \n&gt;         \&quot;data\&quot;: [ 820, 932, 901, 934, 1290, 1330, 1320 ],\n&gt;       \&quot;type\&quot;: \&quot;line\&quot;,\n&gt;       \&quot;areaStyle\&quot;: &#123;&#125;\n&gt;     &#125;\n&gt;   ]\n&gt; &#125;\n&gt; ```\n&gt; &#123;: id=\&quot;20240808092645-7leeodx\&quot; updated=\&quot;20240808092645\&quot;&#125;\n&gt;&quot;" custom-expr-value="&gt; ```echarts_esc_newline_&gt; &#123;_esc_newline_&gt;   &quot;xAxis&quot;: &#123;_esc_newline_&gt;     &quot;type&quot;: &quot;category&quot;,_esc_newline_&gt;     &quot;boundaryGap&quot;: false,_esc_newline_&gt;     &quot;data&quot;: [_esc_newline_&gt;       &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;_esc_newline_&gt;     ]_esc_newline_&gt;   &#125;,_esc_newline_&gt;   &quot;yAxis&quot;: &#123;_esc_newline_&gt;     &quot;type&quot;: &quot;value&quot;_esc_newline_&gt;   &#125;,_esc_newline_&gt;   &quot;series&quot;: [_esc_newline_&gt;     &#123; _esc_newline_&gt;         &quot;data&quot;: [ 820, 932, 901, 934, 1290, 1330, 1320 ],_esc_newline_&gt;       &quot;type&quot;: &quot;line&quot;,_esc_newline_&gt;       &quot;areaStyle&quot;: &#123;&#125;_esc_newline_&gt;     &#125;_esc_newline_&gt;   ]_esc_newline_&gt; &#125;_esc_newline_&gt; ```_esc_newline_&gt; &#123;: id=&quot;20240808092645-7leeodx&quot; updated=&quot;20240808092645&quot;&#125;_esc_newline_&gt;"><div id="20240818115505-dv0b1x7" data-node-id="20240818115505-dv0b1x7" data-type="NodeCodeBlock" updated="20240808092645" data-subtype="echarts" class="render-node" data-content="{
  &quot;xAxis&quot;: {
    &quot;type&quot;: &quot;category&quot;,
    &quot;boundaryGap&quot;: false,
    &quot;data&quot;: [
      &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;
    ]
  },
  &quot;yAxis&quot;: {
    &quot;type&quot;: &quot;value&quot;
  },
  &quot;series&quot;: [
    { 
        &quot;data&quot;: [ 820, 932, 901, 934, 1290, 1330, 1320 ],
      &quot;type&quot;: &quot;line&quot;,
      &quot;areaStyle&quot;: {}
    }
  ]
}">
        <div spin="1"></div>
        <div class="protyle-attr" contenteditable="false"></div>
      </div></div><div id="20240818115505-dv0b1x7" data-node-id="20240818115505-dv0b1x7" data-type="NodeCodeBlock" updated="20240808092645" data-subtype="echarts" class="render-node" data-content="{
  &quot;xAxis&quot;: {
    &quot;type&quot;: &quot;category&quot;,
    &quot;boundaryGap&quot;: false,
    &quot;data&quot;: [
      &quot;Mon&quot;, &quot;Tue&quot;, &quot;Wed&quot;, &quot;Thu&quot;, &quot;Fri&quot;, &quot;Sat&quot;, &quot;Sun&quot;
    ]
  },
  &quot;yAxis&quot;: {
    &quot;type&quot;: &quot;value&quot;
  },
  &quot;series&quot;: [
    { 
        &quot;data&quot;: [ 820, 932, 901, 934, 1290, 1330, 1320 ],
      &quot;type&quot;: &quot;line&quot;,
      &quot;areaStyle&quot;: {}
    }
  ]
}">
        <div spin="1"></div>
        <div class="protyle-attr" contenteditable="false"></div>
      </div><div id="20240808094354-xiq54n9" data-node-id="20240808094354-xiq54n9" data-type="NodeParagraph" updated="20240818115505" class="p" custom-expr="2" custom-expr-value="2"><div spellcheck="false">2</div></div><div id="20240714094026-1oid1cy" data-node-id="20240714094026-1oid1cy" data-type="NodeParagraph" updated="20240818115505" class="p" custom-expr="3" custom-expr-value="3"><div spellcheck="false">3</div></div><h2 id="20240311150423-fy1o4zw" data-node-id="20240311150423-fy1o4zw" data-type="NodeHeading" updated="20240815100915" data-subtype="h2" class="h2">开始烧录固件&连接</h2>
<div id="20240311150505-7an1v0k" data-node-id="20240311150505-7an1v0k" data-type="NodeParagraph" updated="20240318193611" class="p"><div spellcheck="false">esprunio 是需要先将固件写到板子中，然后才可以动态加载 js 代码执行。</div></div>
<div id="20240317185709-e5p0chg" data-node-id="20240317185709-e5p0chg" data-type="NodeParagraph" updated="20240317185820" class="p"><div spellcheck="false">在刷好固件后自动就配对了，但换电脑就需要重新刷配对一次（<span data-type="tag">todo</span>​ 寻找简单配对的方法）</div></div>
<div id="20240721142756-0l2q362" data-node-id="20240721142756-0l2q362" data-type="NodeParagraph" updated="20240721144639" class="p"><div spellcheck="false"></div></div><h3 id="20240314195312-0h0qauu" data-node-id="20240314195312-0h0qauu" data-type="NodeHeading" updated="20240815100915" data-subtype="h3" class="h3">esp8266 NodeMcu 烧录与连接</h3>
<div id="20240314195332-rlp6acx" data-node-id="20240314195332-rlp6acx" data-type="NodeParagraph" updated="20240318193642" class="p"><div spellcheck="false">这块板子足够的便宜，花了12元就买了一块，芯片是 esp12-f ，150Kib ram (<a href="https://segmentfault.com/a/1190000023089715">64KB 的 iRAM，96KB 的 dRAM</a> espruino 中不需要了解这两个的区别，可以理解为有大概120Kib的ram供我们的代码使用，其他空间被 espruino占用了 ) 和 4mb 闪存。</div></div>
<div id="20240314195353-ozgz6zr" data-node-id="20240314195353-ozgz6zr" data-type="NodeParagraph" updated="20240318125814" class="p"><div spellcheck="false">我追随此教程：<a href="https://auth0.com/blog/javascript-for-microcontrollers-and-iot-part-4/">https://auth0.com/blog/javascript-for-microcontrollers-and-iot-part-4/</a> 以及官网教程 <a href="https://www.espruino.com/ESP8266_Flashing">https://www.espruino.com/ESP8266_Flashing</a></div></div>
<div id="20240314195406-1xlhr6x" data-node-id="20240314195406-1xlhr6x" data-type="NodeParagraph" updated="20240318125814" class="p"><div spellcheck="false">先安装 esptool  <a href="https://docs.espressif.com/projects/esptool/en/latest/esp32/installation.html#installation">https://docs.espressif.com/projects/esptool/en/latest/esp32/installation.html#installation</a> ，使用了虚拟环境安装，直接安装报错:</div></div>
<div id="20240314204052-th5h82h" data-node-id="20240314204052-th5h82h" data-type="NodeCodeBlock" updated="20240318125814" class="code-block">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">log</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">error: externally-managed-environment

× This environment is externally managed
╰─> To install Python packages system-wide, try apt install
    python3-xyz, where xyz is the package you are trying to
    install.
  
    If you wish to install a non-Debian-packaged Python package,
    create a virtual environment using python3 -m venv path/to/venv.
    Then use path/to/venv/bin/python and path/to/venv/bin/pip. Make
    sure you have python3-full installed.
  
    If you wish to install a non-Debian packaged Python application,
    it may be easiest to use pipx install xyz, which will manage a
    virtual environment for you. Make sure you have pipx installed.
  
    See /usr/share/doc/python3.11/README.venv for more information.
</div>
      </div>
<div id="20240314204105-i37427r" data-node-id="20240314204105-i37427r" data-type="NodeParagraph" updated="20240318125814" class="p"><div spellcheck="false">搞不懂 python 这一套，感觉它的版本很乱。按照下面的方法安装</div></div>
<div id="20240314204237-ays8qi9" data-node-id="20240314204237-ays8qi9" data-type="NodeBlockquote" updated="20240803104102" class="bq"><div id="20240314204238-uk08gx8" data-node-id="20240314204238-uk08gx8" data-type="NodeList" updated="20240803104102" data-subtype="u" class="list"><div id="20240314204238-pbd4n76" data-node-id="20240314204238-pbd4n76" data-type="NodeListItem" updated="20240314204345" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-kejl7oe" data-node-id="20240314204238-kejl7oe" data-type="NodeParagraph" updated="20240314204345" class="p"><div spellcheck="false">创建一个虚拟环境并选择其名称，例如“esptoolenv”：<span data-type="code">python -m venv esptoolenv</span>​</div></div>
    </div><div id="20240314204238-7t94d6r" data-node-id="20240314204238-7t94d6r" data-type="NodeListItem" updated="20240803104102" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-vk1nzwb" data-node-id="20240314204238-vk1nzwb" data-type="NodeParagraph" updated="20240803104046" class="p"><div spellcheck="false">激活虚拟环境：</div></div><div id="20240314204238-4w66u0o" data-node-id="20240314204238-4w66u0o" data-type="NodeBlockquote" updated="20240803104102" class="bq"><div id="20240314204238-8o2val0" data-node-id="20240314204238-8o2val0" data-type="NodeList" updated="20240803104102" data-subtype="u" class="list"><div id="20240314204238-xe7wcfd" data-node-id="20240314204238-xe7wcfd" data-type="NodeListItem" updated="20240803104102" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-8hc1xw7" data-node-id="20240314204238-8hc1xw7" data-type="NodeParagraph" updated="20240803104102" class="p"><div spellcheck="false">在 Windows 上：<span data-type="code">esptoolenv\Scripts\activate</span>​   (在创建虚拟环境的磁盘中)</div></div>
    </div><div id="20240314204238-tt72tyd" data-node-id="20240314204238-tt72tyd" data-type="NodeListItem" updated="20240314204352" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-m6vq44m" data-node-id="20240314204238-m6vq44m" data-type="NodeParagraph" updated="20240314204352" class="p"><div spellcheck="false">在 Linux 或 MacOS 上：<span data-type="code">source esptoolenv/bin/activate</span>​</div></div>
    </div></div></div>
    </div><div id="20240314204238-f619upb" data-node-id="20240314204238-f619upb" data-type="NodeListItem" updated="20240314204428" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-lzxcoy3" data-node-id="20240314204238-lzxcoy3" data-type="NodeParagraph" updated="20240314204428" class="p"><div spellcheck="false">安装最新的 esptool.py活动虚拟环境中的版本：<span data-type="code">pip install esptool</span>​</div></div>
    </div><div id="20240314204238-ops0ygn" data-node-id="20240314204238-ops0ygn" data-type="NodeListItem" updated="20240314204448" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-fyt0f5f" data-node-id="20240314204238-fyt0f5f" data-type="NodeParagraph" updated="20240314204448" class="p"><div spellcheck="false">您现在可以在此虚拟环境中使用它，而不会影响您的系统范围的安装：<span data-type="code">esptool.py &lt;command&gt;</span>​</div></div>
    </div><div id="20240314204238-m10fv7e" data-node-id="20240314204238-m10fv7e" data-type="NodeListItem" updated="20240314204504" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-x9764ll" data-node-id="20240314204238-x9764ll" data-type="NodeParagraph" updated="20240314204504" class="p"><div spellcheck="false">当你使用完后 esptool.py，停用虚拟环境： <span data-type="code">deactivate</span>​。  通过再次激活环境可以重复使用。</div></div>
    </div><div id="20240314204238-uw2uf8e" data-node-id="20240314204238-uw2uf8e" data-type="NodeListItem" updated="20240314204513" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314204238-07ttyff" data-node-id="20240314204238-07ttyff" data-type="NodeParagraph" updated="20240314204513" class="p"><div spellcheck="false">如果您不再需要虚拟环境，可以通过删除 <span data-type="code">esptoolenv</span>​目录。</div></div>
    </div></div></div>
<div id="20240314204816-ii0xvcy" data-node-id="20240314204816-ii0xvcy" data-type="NodeParagraph" updated="20240721145747" class="p"><div spellcheck="false">去 <a href="https://www.espruino.com/binaries/espruino_2v21_esp8266_4mb/">https://www.espruino.com/binaries/espruino_2v21_esp8266_4mb/</a> 将所有文件都下载到一个目录里，在该路径执行如下命令（在windows 下可能端口略有不同，具体请参照上面链接中的 readme</div></div>
<div id="20240314210514-gnp9qeg" data-node-id="20240314210514-gnp9qeg" data-type="NodeCodeBlock" updated="20240318193948" class="code-block" style="line-height: 22px;">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">bash</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">esptool.py --port /dev/ttyUSB0 --baud 115200 write_flash --flash_freq 80m --flash_mode qio --flash_size 4MB 0x0000 "boot_v1.6.bin" 0x1000 espruino_esp8266_user1.bin 0x3FC000 esp_init_data_default.bin 0x3FE000 blank.bin
</div>
      </div>
<div id="20240803105248-q8kk8ct" data-node-id="20240803105248-q8kk8ct" data-type="NodeCodeBlock" updated="20240803105811" class="code-block" style="line-height: 22px;">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">bash</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">esptool --port COM7 --baud 115200 write_flash --flash_freq 80m --flash_mode qio --flash_size 4MB 0x0000 "boot_v1.6.bin" 0x1000 espruino_esp8266_user1.bin 0x3FC000 esp_init_data_default.bin 0x3FE000 blank.bin
</div>
      </div>
<div id="20240803105838-89c7ic4" data-node-id="20240803105838-89c7ic4" data-type="NodeParagraph" updated="20240803105853" class="p"><div spellcheck="false">已经烧录过固件的先进行清除：</div></div>
<div id="20240803105854-nvi9bj5" data-node-id="20240803105854-nvi9bj5" data-type="NodeCodeBlock" updated="20240815100915" class="code-block" style="line-height: 22px; outline: red solid 1px;">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">js</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">esptool.py --port [/dev/ttyUSB0|COM1] --baud 115200 erase_flash
</div>
      </div>
<div id="20240803105838-6iqt9bw" data-node-id="20240803105838-6iqt9bw" data-type="NodeParagraph" updated="20240803110253" class="p"><div spellcheck="false"></div></div>
<div id="20240314204011-vogfd0z" data-node-id="20240314204011-vogfd0z" data-type="NodeParagraph" updated="20240318194146" class="p"><div spellcheck="false">提示要添加用户组，添加后重启电脑就能运行了，其中 flash_size 官网填的是  32m 但我运行报错， 改成 4MB （4*8=32mbit）后就可以了。<br><span data-type="code">/dev/ttyUSB0</span>​ 是插入的单片机串口名。</div></div>
<div id="20240314210602-s0ndllu" data-node-id="20240314210602-s0ndllu" data-type="NodeParagraph" updated="20240318194152" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" parent-style="width: 552px;" style="width: 542px;" style="width: 552px;">
<img
  src="./../../assets/image-20240314210602-oxm5usv.png"
  data-src="./../../assets/image-20240314210602-oxm5usv.png"
  title=""
  style="width: 542px;"
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>一阵闪烁后成功了。</div></div>
<div id="20240314210618-8puhlj6" data-node-id="20240314210618-8puhlj6" data-type="NodeParagraph" updated="20240318125814" class="p"><div spellcheck="false">在 chrome 浏览器打开 <a href="https://www.espruino.com/ide">https://www.espruino.com/ide</a> （我使用 chromium打开无法看到串口设备）</div></div>
<div id="20240314210918-ejy4f5y" data-node-id="20240314210918-ejy4f5y" data-type="NodeList" updated="20240318125814" data-subtype="u" class="list"><div id="20240314210918-666nh6h" data-node-id="20240314210918-666nh6h" data-type="NodeListItem" updated="20240314210918" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314210918-6or89ac" data-node-id="20240314210918-6or89ac" data-type="NodeParagraph" updated="20240314210918" class="p"><div spellcheck="false">单击 <span data-type="code">Gear</span>​屏幕右上角的图标。</div></div>
    </div><div id="20240314210918-1sz8hgh" data-node-id="20240314210918-1sz8hgh" data-type="NodeListItem" updated="20240314210918" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314210918-hzifw2s" data-node-id="20240314210918-hzifw2s" data-type="NodeParagraph" updated="20240314210918" class="p"><div spellcheck="false">现在去 <span data-type="code">Communications</span>​在左侧。</div></div>
    </div><div id="20240314210918-8x0hbg6" data-node-id="20240314210918-8x0hbg6" data-type="NodeListItem" updated="20240314210918" data-subtype="u" class="li" data-marker="*">
      <div class="protyle-action">
        <svg><use xlink:href="#iconDot"></use></svg>
      </div>
      <div id="20240314210918-3pv6dcf" data-node-id="20240314210918-3pv6dcf" data-type="NodeParagraph" updated="20240314210955" class="p"><div spellcheck="false">设置 <span data-type="code">Baud Rate</span>​到9600（我这块板子标得是9600，我看网上其他教程是115200 ）</div></div>
    </div></div>
<div id="20240314213139-vbuxequ" data-node-id="20240314213139-vbuxequ" data-type="NodeParagraph" updated="20240318125814" class="p"><div spellcheck="false">连接后我这里提示 <span data-type="code">Unable to retrieve board information. Connection Error?</span>​ 也无法发送代码过去，然后看到这篇帖子：https://forum.espruino.com/conversations/318073/ 中提及波特率，我又改回 115200 连接成功（😮‍💨，板子后面的标识 9600 坑我</div></div>
<div id="20240314213516-ucr5cow" data-node-id="20240314213516-ucr5cow" data-type="NodeParagraph" updated="20240318125814" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" parent-style="width: 577px;" style="width: 567px;" style="width: 577px;">
<img
  src="./../../assets/image-20240314213516-gf51wxe.png"
  data-src="./../../assets/image-20240314213516-gf51wxe.png"
  title="连接成功，上方是之前失败的"
  style="width: 567px;"
  loading="lazy"
/>
<span class="protyle-action__title">连接成功，上方是之前失败的</span></span>​</div></div>
<div id="20240314213536-ix03dz8" data-node-id="20240314213536-ix03dz8" data-type="NodeParagraph" updated="20240721145150" class="p"><div spellcheck="false">进阶使用(浏览器里链接不上也可以看看这里使用 esprunio 的 cli 连接)： <span data-type="block-ref" data-subtype="d" data-id="20240311144314-1b3lcji"><a href="./../../daily note/2024/03/espruino.html#20240311144314-1b3lcji">espruino + typescript + vscode</a></span></div></div>
<div id="20240803110256-a949def" data-node-id="20240803110256-a949def" data-type="NodeParagraph" updated="20240803110308" class="p"><div spellcheck="false">在无法读取板信息的情况下主动指定 http://www.espruino.com/json/</div></div>
<div id="20240803110309-eiryr6q" data-node-id="20240803110309-eiryr6q" data-type="NodeParagraph" updated="20240803110309" class="p"><div spellcheck="false"></div></div><div id="20240803105854-nvi9bj5" data-node-id="20240803105854-nvi9bj5" data-type="NodeCodeBlock" updated="20240815100915" class="code-block" style="line-height: 22px; outline: red solid 1px;">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">js</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">esptool.py --port [/dev/ttyUSB0|COM1] --baud 115200 erase_flash
</div>
      </div><h3 id="20240815094954-wrjhdfi" data-node-id="20240815094954-wrjhdfi" data-type="NodeHeading" updated="20240815100555" data-subtype="h3" class="h3"><span data-type="block-ref" data-subtype="d" data-id="20240815094954-25sj3sn"><a href="./../../想法/项目/toolkit-plugin-siyuan/思源简单冲突对比.html#20240815094954-25sj3sn">思源简单冲突对比</a></span></h3><div id="20240815095003-j74ovbg" data-node-id="20240815095003-j74ovbg" data-type="NodeParagraph" updated="20240815100541" class="p"><div spellcheck="false">安装 toolkit 插件 <span data-type="code">0.0.12</span>​ 并启用之后</div></div><div id="20240815100354-1znwvnh" data-node-id="20240815100354-1znwvnh" data-type="NodeParagraph" updated="20240815100420" class="p"><div spellcheck="false">其中 update 字段不一致的块会被标记红色外框。</div></div><div id="20240815095123-a7yhcgd" data-node-id="20240815095123-a7yhcgd" data-type="NodeParagraph" updated="20240815100354" class="p"><div spellcheck="false">现在你可以将鼠标放在两个窗口中间的resize分割线上滚动滚轮从而同时滚动两个窗口</div></div><div id="20240815100350-thl5ixk" data-node-id="20240815100350-thl5ixk" data-type="NodeParagraph" updated="20240815100350" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" style="">
<img
  src="./../../assets/image-20240815100350-bhc9y1y.png"
  data-src="./../../assets/image-20240815100350-bhc9y1y.png"
  title=""
  style=""
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><div id="20240815100200-d05mo0a" data-node-id="20240815100200-d05mo0a" data-type="NodeParagraph" updated="20240815100225" class="p"><div spellcheck="false">然后打开命令面板执行 <span data-type="code">conflicted Comparison</span>​ 命令</div></div><div id="20240815100157-80hw88d" data-node-id="20240815100157-80hw88d" data-type="NodeParagraph" updated="20240815100157" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" style="">
<img
  src="./../../assets/image-20240815100157-4wixzzf.png"
  data-src="./../../assets/image-20240815100157-4wixzzf.png"
  title=""
  style=""
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><div id="20240815095208-hz4lvsx" data-node-id="20240815095208-hz4lvsx" data-type="NodeParagraph" updated="20240815095235" class="p"><div spellcheck="false">先并排放两个文档窗口</div></div><div id="20240815095201-vcacdd8" data-node-id="20240815095201-vcacdd8" data-type="NodeParagraph" updated="20240815095201" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" style="">
<img
  src="./../../assets/image-20240815095201-ex5gbfl.png"
  data-src="./../../assets/image-20240815095201-ex5gbfl.png"
  title=""
  style=""
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><h3 id="20240815094950-w8ijgvb" data-node-id="20240815094950-w8ijgvb" data-type="NodeHeading" updated="20240815094954" data-subtype="h3" class="h3">标签排序</h3><h2 id="20210521142713-utzshpn" data-node-id="20210521142713-utzshpn" data-type="NodeHeading" updated="20240813095453" data-subtype="h2" class="h2">node 版本管理</h2>
<div id="20240813094743-df5uxq9" data-node-id="20240813094743-df5uxq9" data-type="NodeParagraph" updated="20240813095453" class="p"><div spellcheck="false">fnm（推荐使用） ：全平台</div></div><div id="20240813094743-df5uxq9" data-node-id="20240813094743-df5uxq9" data-type="NodeParagraph" updated="20240813095453" class="p"><div spellcheck="false">fnm（推荐使用） ：全平台</div></div><h2 id="20240813094740-sfs3oep" data-node-id="20240813094740-sfs3oep" data-type="NodeHeading" updated="20240813094742" data-subtype="h2" class="h2"> (n\nvm) 不支持 windows</h2>
<div id="20210521142713-nihh3ez" data-node-id="20210521142713-nihh3ez" data-type="NodeCodeBlock" class="code-block">
        <div class="protyle-action">
          <span class="protyle-action--first protyle-action__language">bash</span>
          <span class="fn__flex-1"></span><span class="protyle-icon protyle-icon--only protyle-action__copy"><svg><use xlink:href="#iconCopy"></use></svg></span>
        </div>
        <div class="hljs" spellcheck="false">$ npm i -g n    # n 模块是专门用来管理node版本的

#安装node版本  也可以安装指定版
$ n latest      # 安装最新版
$ n stable      # 安装稳定版
$ n lts         # 安装最新的LTS官方版本
</div>
      </div>
<div id="20231207095234-5qtalax" data-node-id="20231207095234-5qtalax" data-type="NodeParagraph" class="p"><div spellcheck="false"></div></div><div id="20240812180104-mrv9yfq" data-node-id="20240812180104-mrv9yfq" data-type="NodeParagraph" updated="20240812180128" class="p"><div spellcheck="false">安装 <span data-type="code"><a href="https://github.com/2234839/toolkit-plugin-siyuan">toolkit-plugin-siyuan</a></span>​ 插件</div></div><div id="20240812180102-ko04rlj" data-node-id="20240812180102-ko04rlj" data-type="NodeParagraph" updated="20240812180102" class="p"><div spellcheck="false">越常用的标签会排在越前面。
相关数据存储在 SiYuan/data/storage/petal/toolkit-plugin-siyuan/tagSort.json</div></div><div id="20240812180102-paipjz3" data-node-id="20240812180102-paipjz3" data-type="NodeParagraph" updated="20240812180102" class="p"><div spellcheck="false">​<span data-type="NodeImage" class="img" style="">
<img
  src="./../../assets/image-20240812175943-160a5gr.png"
  data-src="./../../assets/image-20240812175943-160a5gr.png"
  title=""
  style=""
  loading="lazy"
/>
<span class="protyle-action__title"></span></span>​</div></div><div id="20240812175941-0pamkj2" data-node-id="20240812175941-0pamkj2" data-type="NodeParagraph" updated="20240812180057" class="p"><div spellcheck="false">我自己使用的一个工具箱插件
目前支持的功能，</div></div><div id="20240812175925-pv8772q" data-node-id="20240812175925-pv8772q" data-type="NodeParagraph" updated="20240812175940" class="p"><div spellcheck="false">https://github.com/2234839/toolkit-plugin-siyuan/tree/main</div></div><div id="20210523142634-ipm20fu" data-node-id="20210523142634-ipm20fu" data-type="NodeParagraph" updated="20240812123836" class="p"><div spellcheck="false"><a href="https://github.com/wendux/Ajax-hook">https://github.com/wendux/Ajax-hook</a>  请求拦截</div></div><div id="20240811152622-thbzkc5" data-node-id="20240811152622-thbzkc5" data-type="NodeParagraph" updated="20240811152622" class="p"><div spellcheck="false"></div></div><div id="20240808102207-4eeimoi" data-node-id="20240808102207-4eeimoi" data-type="NodeParagraph" updated="20240808102207" class="p"><div spellcheck="false"></div></div></div><div id="20210606160324-57c0iql" data-node-id="20210606160324-57c0iql" data-type="NodeParagraph" updated="20230924170522" class="p"><div spellcheck="false"></div></div>
  </div>
  <script src="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/appearance/icons/material/icon.js?2.10.5"></script>
  <script src="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/stage/build/export/protyle-method.js?2.10.5"></script>
  <script src="https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/stage/protyle/js/lute/lute.min.js?2.10.5"></script>
  <script>
    window.siyuan = {
      config: {
        appearance: {
          mode: isNightTime()?1:0,//主题 明亮=0 暗黑=1
          codeBlockThemeDark: "base16/dracula",
          codeBlockThemeLight: "github",
        },
        editor: {
          codeLineWrap: true,
          codeLigatures: false,
          plantUMLServePath: "https://www.plantuml.com/plantuml/svg/~1",
          codeSyntaxHighlightLineNum: true,
          katexMacros: JSON.stringify({}),
        },
      },
      languages: { copy: "复制" },
    };
    const cdn = "https://fastly.jsdelivr.net/gh/siyuan-note/oceanpress@v0.0.7/apps/frontend/public/notebook/stage/protyle";
    const previewElement = document.getElementById("preview");

    Protyle.highlightRender(previewElement, cdn);
    Protyle.mathRender(previewElement, cdn, false);
    Protyle.mermaidRender(previewElement, cdn);
    Protyle.flowchartRender(previewElement, cdn);
    Protyle.graphvizRender(previewElement, cdn);
    Protyle.chartRender(previewElement, cdn);
    Protyle.mindmapRender(previewElement, cdn);
    Protyle.abcRender(previewElement, cdn);
    Protyle.htmlRender(previewElement);
    Protyle.plantumlRender(previewElement, cdn);
    document.querySelectorAll(".protyle-action__copy").forEach((item) => {
      item.addEventListener("click", (event) => {
        navigator.clipboard.writeText(
          item.parentElement.nextElementSibling.textContent.trimEnd(),
        );
        event.preventDefault();
        event.stopPropagation();
      });
    });
  </script>
  <footer>
<p style="text-align:center;margin:15px 0;">
  技术支持：
  <a target="_blank" href="https://github.com/2234839/oceanPress_js">OceanPress</a>|
    <a target="_blank" href="https://heartstack.space/user/%E5%AD%90%E8%99%9A/posts">崮生（子虚）</a> |
    <a target="_blank" href="//beian.miit.gov.cn">湘ICP备18021783号-1</a>
</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script type="text/javascript">
  docsearch({
    appId: "UBOM0V691R",
    apiKey: "0c572ae8b8611d29477570967f44c3cf",
    indexName: "shenzilong",
    insights: true, 
    container: '#search',
    debug: false
  });
</script>
</body>
</html>